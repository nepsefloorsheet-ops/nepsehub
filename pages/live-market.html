<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Live-market | NEPSE Hub</title>
    <link rel="shortcut icon" href="../img/favicon/NH.png" type="image/x-icon" />
    <link rel="stylesheet" href="../src/css/global.css" />
    <link rel="stylesheet" href="../src/css/market/live-market.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Outfit:wght@500;600;700&family=Roboto+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>

  <body>
    <div id="layout"></div>
    <main class="active">
      <header class="header">
        <div class="header-items">
          <div class="header-group">
            <div class="header-col">
              <span class="header-col-label">NEPSE Index</span>
              <div id="nepseData" class="flex gap-10 items-baseline">
                <span class="index-value">--</span>
                <div class="flex column">
                  <span class="difference">--</span>
                  <span class="percent-ch">(--)</span>
                </div>
              </div>
            </div>
            <div class="divider-v"></div>
            <span class="pulse-dot" id="headerPulse"></span>
            <div class="turnover-volume">
              <div class="header-col">
                <div class="header-col-item">
                  <span class="header-col-label">Total Turnover</span>
                  <span class="header-col-value turnover">--</span>
                </div>
                <div class="header-col-item">
                  <span class="header-col-label">Total Volume</span>
                  <span class="header-col-value volume">--</span>
                </div>
              </div>
            </div>
          </div>

          <div class="header-group">
            <div class="header-col right">
              <span
                id="currentDate"
                class="header-col-label"
                style="font-size: 0.9rem"
                >---, -- ---</span
              >
              <span
                id="currentTime"
                class="header-col-value"
                style="font-size: 0.9rem"
                >--:--:--</span
              >
            </div>
            <div class="divider-v"></div>
            <div class="header-col items-center">
              <div class="flex items-center gap-8" style="margin-bottom: 2px">
                <span id="market-status" class="market-pill">Checking...</span>
              </div>
              <div class="theme-switcher">
                <button class="theme-btn" data-theme="dark" title="Dark Mode">
                  <i class="fa-solid fa-moon"></i>
                </button>
                <button class="theme-btn" data-theme="light" title="Light Mode">
                  <i class="fa-regular fa-sun"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      </header>

      <div class="content">
        <section>
          <div class="livetable top sticky-header" id="stickyHeader">
            <!-- Count Adv. Dec. Unc. -->
            <div class="count-container">
              <p
                class="positiveCount clickable-filter"
                id="filterPositive"
                data-filter="positive"
              >
                Advances:
                <span id="advances-count">--</span>
              </p>
              <p
                class="negativeCount clickable-filter"
                id="filterNegative"
                data-filter="negative"
              >
                Declines:
                <span id="declines-count">--</span>
              </p>
              <p
                class="unchangedCount clickable-filter"
                id="filterUnchanged"
                data-filter="unchanged"
              >
                Neutral:
                <span id="neutral-count">--</span>
              </p>
            </div>
            <h3 id="live-market">Live Market</h3>
            <div id="lastUpdated" class="last-updated">
              <span id="refreshIndicator" class="refresh-indicator u-hidden"
                >⟳</span
              >
              <span id="lastUpdatedText">As of: --</span>
            </div>
          </div>

          <div class="search-container">
            <select id="sectorFilter" class="sector-dropdown">
              <option value="">All Sectors</option>
              <option value="COMMERCIAL BANKS">COMMERCIAL BANKS</option>
              <option value="DEVELOPMENT BANKS">DEVELOPMENT BANKS</option>
              <option value="HYDRO POWER">HYDRO POWER</option>
              <option value="FINANCE">FINANCE</option>
              <option value="MICROFINANCE">MICROFINANCE</option>
              <option value="Mutual Fund">Mutual Fund</option>
              <option value="LIFE INSURANCE">LIFE INSURANCE</option>
              <option value="NON LIFE INSURANCE">NON LIFE INSURANCE</option>
              <option value="HOTELS AND TOURISM">HOTELS AND TOURISM</option>
              <option value="MANUFACTURING AND PROCESSING">
                MANUFACTURING AND PROCESSING
              </option>
              <option value="INVESTMENT">INVESTMENT</option>
              <option value="TRADINGS">TRADINGS</option>
              <option value="OTHERS">OTHERS</option>
            </select>
            <input
              type="text"
              id="symbol-search"
              placeholder="Enter symbol to search..."
            />
            <button id="searchBtn">
              <i class="fa-solid fa-magnifying-glass"></i> Search
            </button>
            <button id="clearBtn">
              <i class="fa-solid fa-rotate-left"></i> Clear
            </button>
          </div>

          <div class="livetable" id="tableContainer">
            <div
              class="scroll-indicator scroll-indicator-left"
              id="scrollLeftIndicator"
            >
              ‹
            </div>
            <div
              class="scroll-indicator scroll-indicator-right"
              id="scrollRightIndicator"
            >
              ›
            </div>
            <table id="dataTable">
              <thead>
                <tr>
                  <th style="text-align: left">Symbol</th>
                  <th class="right">LTP</th>
                  <th class="right">LTV</th>
                  <th class="right">Point Change</th>
                  <th class="right">%Change</th>
                  <th class="right">Open</th>
                  <th class="right">High</th>
                  <th class="right">Low</th>
                  <th class="right">Prev Close</th>
                  <th class="right">Volume</th>
                  <th class="right">Turnover</th>
                </tr>
              </thead>

              <tbody id="market-data"></tbody>
            </table>
          </div>
        </section>
      </div>
    </main>
    <script src="../src/js/utils/cleanup-manager.js"></script>
    <script src="../src/js/utils/error-handler.js"></script>
    <script src="../src/js/services/api-service.js"></script>
    <script defer src="../src/js/layout.js?v=2"></script>
    <script defer src="../src/js/global.js?v=2"></script>
    <script defer src="../src/js/market/live-market.js?v=2"></script>
  </body>
</html>
